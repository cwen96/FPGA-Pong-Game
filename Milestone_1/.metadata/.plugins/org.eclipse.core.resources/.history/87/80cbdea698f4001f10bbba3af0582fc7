#include "game.h"

Game::Game(int mode){
	score = {0,0};
	ballLocationX = 620;
	ballLocationY = 492;
	ballXVelocity = 10;
	ballYVelocity = 2;
	leftPaddleLocation = 400;
	rightPaddleLocation = 400;
	if(mode == 1){
		//initialize computer player
	}
}

void Game::resetBall(){
	ballLocationX = 620;
	ballLocationY = 492;
}

void Game::awardPoint(int player){
	score[player]++;
	//check victory condition
	if(score[player] == 11){
		//display Player x wins to screen, record and end game
	}
}

void Game::checkWallCollision(){//check if on next frame ball will contact wall, then handle if so
	if(ballYVelocity>0){//moving down
		if(SCREEN_HEIGHT-ballLocationY < ballYVelocity){
			ballYVelocity = ballYVelocity*(-1);
			//TODO:write collision flag to shared memory for sound to play
		}
	}else{
		if(ballLocationY < ballYVelocity){
			ballYVelocity = ballYVelocity*(-1);
			//TODO:write collision flag to shared memory for sound to play
		}
	}
}

void Game::checkPaddleCollision(){
	if(ballXVelocity > 0){//moving right, check collision with right paddle
		if(ballXVelocity > (1230-ballLocationX)){//ball velocity means that in the next frame the ball will contact the paddle
			if(ballLocationY > rightPaddleLocation+BALL_DIAMETER && ballLocationY < rightPaddleLocation+PADDLE_HEIGHT){
				ballXVelocity= (ballXVelocity+2)*(-1);
				//TODO:adjust Y velocity depending on where the ball contacted paddle
			}
		}
	}else{
		if(ballXVelocity < (ballLocationX-90)){//ball velocity is higher than distance to paddle i.e. will contact in next frame
			if(ballLocationY > leftPaddleLocation+BALL_DIAMETER && ballLocationY < leftPaddleLocation+PADDLE_HEIGHT){
				ballXVelocity = (ballXVelocity+2)*(-1);//increase x velocity and invert direction
				//TODO:adjust Y velocity depending on where the ball contacted paddle
			}
		}
	}
}
